        .avatar-sm { width: 32px; height: 32px; border-radius: 10px; object-fit: cover; }
        .badge { padding: 4px 10px; border-radius: 12px; font-size: 10px; font-weight: 600; white-space: nowrap;}
        .badge.green { background: #d1fae5; color: #059669; }
        .badge.red { background: #fee2e2; color: #b91c1c; }
        .action-icon { background: #f1f5f9; border: none; border-radius: 6px; padding: 6px 8px; cursor: pointer; color: var(--text-muted); font-size: 13px; margin-left: 3px; transition: 0.2s;}
        .action-icon:hover { background: #e2e8f0; color: var(--danger); }

        /* ================= ‡¶¨‡¶ü‡¶Æ ‡¶®‡ßá‡¶≠‡¶ø‡¶ó‡ßá‡¶∂‡¶® ================= */
        .bottom-nav { position: fixed; bottom: 0; left: 0; width: 100%; background: var(--nav-bg); border-top-left-radius: 25px; border-top-right-radius: 25px; display: flex; justify-content: space-between; align-items: center; padding: 8px 15px 15px; box-sizing: border-box; z-index: 100; box-shadow: 0 -5px 15px rgba(0,0,0,0.1);}
        .nav-item { display: flex; flex-direction: column; align-items: center; color: white; opacity: 0.5; font-size: 11px; cursor: pointer; flex: 1; transition: 0.3s;}
        .nav-item.active { opacity: 1; color: #93c5fd; }
        .nav-icon { font-size: 20px; margin-bottom: 2px; }
        .fab-wrapper { position: relative; top: -30px; display: flex; justify-content: center; width: 60px; }
        .fab-btn { background: var(--primary); width: 55px; height: 55px; border-radius: 50%; border: 5px solid var(--app-bg); display: flex; justify-content: center; align-items: center; color: white; font-size: 26px; cursor: pointer; box-shadow: 0 4px 10px rgba(59, 130, 246, 0.4); border: none; outline: none; }

        /* ================= ‡¶™‡¶™-‡¶Ü‡¶™ ‡¶Æ‡¶°‡¶æ‡¶≤ ================= */
        .modal-overlay { visibility: hidden; opacity: 0; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(15, 23, 42, 0.7); display: flex; justify-content: center; align-items: flex-end; z-index: 1000; transition: 0.3s; }
        .modal-overlay.active { visibility: visible; opacity: 1; }
        .modal-content { background: white; width: 100%; max-width: 500px; padding: 25px 20px 30px; border-radius: 24px 24px 0 0; transform: translateY(100%); transition: 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275); max-height: 85vh; overflow-y: auto; box-sizing: border-box; }
        .modal-overlay.active .modal-content { transform: translateY(0); }
        .close-btn { position: absolute; top: 15px; right: 15px; background: #f1f5f9; border: none; width: 32px; height: 32px; border-radius: 50%; font-size: 18px; font-weight: bold; color: var(--text-muted); cursor: pointer; }
        
        .input-group { margin-bottom: 15px; }
        .input-group label { display: block; font-size: 12px; font-weight: 500; margin-bottom: 5px; color: var(--text-muted); }
        .input-group input, .input-group select { width: 100%; padding: 12px 15px; border: 1.5px solid #e2e8f0; border-radius: 12px; font-size: 13px; box-sizing: border-box; background: #f8fafc; outline: none; transition: 0.3s;}
        .input-group input:focus, .input-group select:focus { border-color: var(--primary); background: white; }
        
        .btn-app { width: 100%; padding: 14px; border-radius: 12px; font-size: 14px; font-weight: 600; border: none; color: white; cursor: pointer; margin-top: 5px; transition: 0.2s;}
        .btn-app:active { transform: scale(0.98); }
        .btn-primary { background: var(--primary); }
        .btn-success { background: var(--success); }
        .btn-danger { background: var(--danger); }
        .btn-info { background: var(--info); color: white;}

        /* ‡¶™‡ßç‡¶∞‡ßã‡¶´‡¶æ‡¶á‡¶≤ ‡¶ó‡ßç‡¶∞‡¶ø‡¶° ‡¶¨‡¶æ‡¶ü‡¶® */
        .profile-header { text-align: center; border-bottom: 1px solid #f1f5f9; padding-bottom: 15px; margin-bottom: 15px; }
        .avatar-lg { width: 80px; height: 80px; border-radius: 20px; object-fit: cover; box-shadow: 0 4px 10px rgba(0,0,0,0.1);}
        .edit-photo-badge { position: absolute; bottom: -5px; right: -5px; background: var(--primary); color: white; padding: 8px; border-radius: 50%; font-size: 12px; cursor: pointer; box-shadow: 0 2px 5px rgba(0,0,0,0.2); border: 2px solid white; display: flex; align-items: center; justify-content: center;}
        
        .profile-stats { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-bottom: 15px; }
        .stat-box { padding: 12px; border-radius: 16px; text-align: center; border: 1px solid transparent;}
        .stat-box.deposit { background: #f0fdf4; border-color: #dcfce7; }
        .stat-box.loan { background: #fef2f2; border-color: #fee2e2; }
        .stat-box span { display: block; font-size: 20px; font-weight: 700; margin-bottom: 2px;}
        .stat-box small { font-size: 11px; font-weight: 500; color: var(--text-muted); }

        /* ================= ‡¶ï‡¶æ‡¶∏‡ßç‡¶ü‡¶Æ ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶≤‡¶æ‡¶∞‡ßç‡¶ü ================= */
        .custom-popup-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(15, 23, 42, 0.7); display: flex; justify-content: center; align-items: center; z-index: 999999; visibility: hidden; opacity: 0; transition: 0.3s; padding: 20px; box-sizing: border-box;}
        .custom-popup-overlay.active { visibility: visible; opacity: 1; }
        .custom-popup-box { background: white; padding: 25px; border-radius: 20px; width: 100%; max-width: 320px; text-align: center; transform: scale(0.9); transition: 0.3s; box-shadow: 0 20px 40px rgba(0,0,0,0.2); }
        .custom-popup-overlay.active .custom-popup-box { transform: scale(1); }
        .custom-popup-msg { margin: 0 0 20px 0; color: var(--nav-bg); font-size: 15px; font-weight: 600; line-height: 1.5; }

        /* ================= ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶°‡¶Æ‡¶ø‡¶® ‡¶ì ‡¶∏‡¶ø‡¶ï‡¶ø‡¶â‡¶∞‡¶ø‡¶ü‡¶ø ‡¶≤‡¶ú‡¶ø‡¶ï ================= */
        .admin-only { display: none !important; }
        .admin-only-flex { display: none !important; }
        body.admin-mode .admin-only { display: inline-block !important; }
        body.admin-mode td.admin-only, body.admin-mode th.admin-only { display: table-cell !important; }
        body.admin-mode div.admin-only { display: block !important; }
        body.admin-mode .admin-only-flex { display: flex !important; }

        .editable { pointer-events: none; } 
        body.edit-mode .editable { cursor: pointer; border-bottom: 1px dashed var(--primary); position: relative; display: inline-block; pointer-events: auto;}
        body.edit-mode .editable::after { content: ' ‚úèÔ∏è'; font-size: 12px; opacity: 0.7; vertical-align: top; margin-left: 2px; }
        body.edit-mode .editable:hover { opacity: 0.5; }

        @media (min-width: 600px) {
            .modal-overlay { align-items: center; }
            .modal-content { border-radius: 24px; transform: scale(0.95); }
            .modal-overlay.active .modal-content { transform: scale(1); }
        }
    </style>
</head>
<body>

    <div id="startupLoader">
        <div class="club-spinner"><div class="dot dot1"></div><div class="dot dot2"></div><div class="dot dot3"></div><div class="dot dot4"></div></div>
        <h2 style="color: var(--primary); font-weight: 600;" id="loaderText">‡¶∏‡¶æ‡¶∞‡ßç‡¶≠‡¶æ‡¶∞ ‡¶ï‡¶æ‡¶®‡ßá‡¶ï‡ßç‡¶ü ‡¶π‡¶ö‡ßç‡¶õ‡ßá...</h2>
    </div>

    <div id="actionLoader">
        <div class="club-spinner"><div class="dot dot1"></div><div class="dot dot2"></div><div class="dot dot3"></div><div class="dot dot4"></div></div>
        <h3 id="actionLoaderText" style="color:white; margin-top: 25px; font-size: 14px; font-weight: 500;">‡¶™‡ßç‡¶∞‡¶∏‡ßá‡¶∏‡¶ø‡¶Ç ‡¶π‡¶ö‡ßç‡¶õ‡ßá...</h3>
    </div>

    <div id="customAlert" class="custom-popup-overlay">
        <div class="custom-popup-box">
            <div style="font-size: 40px; color: var(--primary); margin-bottom: 10px;"><i class="fas fa-info-circle"></i></div>
            <h3 class="custom-popup-msg" id="customAlertMsg">‡¶Æ‡ßá‡¶∏‡ßá‡¶ú</h3>
            <button class="btn-app btn-primary" onclick="closeCustomAlert()">‡¶†‡¶ø‡¶ï ‡¶Ü‡¶õ‡ßá</button>
        </div>
    </div>
    <div id="customConfirm" class="custom-popup-overlay">
        <div class="custom-popup-box">
            <div style="font-size: 40px; color: var(--danger); margin-bottom: 10px;"><i class="fas fa-exclamation-triangle"></i></div>
            <h3 class="custom-popup-msg" id="customConfirmMsg">‡¶Ü‡¶™‡¶®‡¶ø ‡¶ï‡¶ø ‡¶®‡¶ø‡¶∂‡ßç‡¶ö‡¶ø‡¶§?</h3>
            <div style="display: flex; gap: 10px;">
                <button class="btn-app" style="background: #e2e8f0; color: var(--text-main);" onclick="closeCustomConfirm(false)">‡¶¨‡¶æ‡¶§‡¶ø‡¶≤</button>
                <button class="btn-app btn-danger" onclick="closeCustomConfirm(true)">‡¶π‡ßç‡¶Ø‡¶æ‡¶Å, ‡¶®‡¶ø‡¶∂‡ßç‡¶ö‡¶ø‡¶§</button>
            </div>
        </div>
    </div>
    <div id="customPrompt" class="custom-popup-overlay">
        <div class="custom-popup-box">
            <h3 class="custom-popup-msg" id="customPromptMsg">‡¶®‡¶§‡ßÅ‡¶® ‡¶≤‡ßá‡¶ñ‡¶æ ‡¶¶‡¶ø‡¶®</h3>
            <input type="text" id="customPromptInput" style="width: 100%; padding: 12px; border: 1.5px solid #e2e8f0; border-radius: 10px; margin-bottom: 15px; outline: none; font-family: 'Poppins', sans-serif;">
            <div style="display: flex; gap: 10px;">
                <button class="btn-app" style="background: #e2e8f0; color: var(--text-main);" onclick="closeCustomPrompt(null)">‡¶¨‡¶æ‡¶§‡¶ø‡¶≤</button>
                <button class="btn-app btn-primary" onclick="submitCustomPrompt()">‡¶∏‡ßá‡¶≠ ‡¶ï‡¶∞‡ßÅ‡¶®</button>
            </div>
        </div>
    </div>

    <div class="container">
        <header>
            <div class="header-title">
                <img id="mainClubLogo" src="https://ui-avatars.com/api/?background=3b82f6&color=fff&bold=true&name=C" class="club-logo" onclick="clickLogoUpload()">
                <input type="file" id="clubLogoUpload" class="admin-only" style="display:none;" accept="image/*" onchange="updateClubLogo(this)">
                <span id="txtClubName" class="editable" onclick="editUIText('txtClubName')">‡¶Ü‡¶Æ‡¶æ‡¶¶‡ßá‡¶∞ ‡¶ï‡ßç‡¶≤‡¶æ‡¶¨</span>
            </div>
            
            <div class="header-actions">
                <div class="edit-switch-wrapper admin-only-flex">
                    <span class="switch-label">üìù ‡¶è‡¶°‡¶ø‡¶ü</span>
                    <label class="toggle-switch">
                        <input type="checkbox" id="editModeToggle" onchange="toggleEditMode()">
                        <span class="slider"></span>
                    </label>
                </div>
                <button class="login-btn" id="mainLoginBtn" onclick="openAdminLogin()">
                    <i class="fas fa-lock"></i> LOGIN
                </button>
            </div>
        </header>

        <div class="welcome-sec">
            <h1 id="txtDashTitle" class="editable" onclick="editUIText('txtDashTitle')">‡¶°‡ßç‡¶Ø‡¶æ‡¶∂‡¶¨‡ßã‡¶∞‡ßç‡¶°</h1>
            <p id="txtDashSub" class="editable" onclick="editUIText('txtDashSub')">‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶ï‡ßç‡¶≤‡¶æ‡¶¨‡ßá‡¶∞ ‡¶π‡¶ø‡¶∏‡¶æ‡¶¨ ‡¶è‡¶ï ‡¶®‡¶ú‡¶∞‡ßá ‡¶¶‡ßá‡¶ñ‡ßÅ‡¶®</p>
        </div>

        <div id="dashboard" class="page-section active">
            <div class="dashboard-grid">
                <div class="card-dark"><h3 id="txtCard1" class="editable" onclick="editUIText('txtCard1')">‡¶Æ‡ßã‡¶ü ‡¶´‡¶æ‡¶®‡ßç‡¶° (‡¶∏‡¶Ç‡¶ó‡ßç‡¶∞‡¶π)</h3><p class="amount" id="dashTotalFund">‡ß¶ ‡ß≥</p></div>
                <div class="card-dark" style="background: #0f172a;"><h3 id="txtCard2" class="editable" onclick="editUIText('txtCard2')">‡¶¨‡¶∞‡ßç‡¶§‡¶Æ‡¶æ‡¶® ‡¶ï‡ßç‡¶Ø‡¶æ‡¶∂</h3><p class="amount" id="dashAvailableCash" style="color: #6ee7b7;">‡ß¶ ‡ß≥</p></div>
                <div class="card-light"><h3 id="txtCard3" class="editable" onclick="editUIText('txtCard3')">‡¶∏‡¶¶‡¶∏‡ßç‡¶Ø‡¶¶‡ßá‡¶∞ ‡¶ã‡¶£</h3><p class="amount" id="dashTotalLoan" style="color: var(--danger);">‡ß¶ ‡ß≥</p></div>
                <div class="card-light"><h3 id="txtCard4" class="editable" onclick="editUIText('txtCard4')">‡¶Ö‡¶®‡ßÅ‡¶¶‡¶æ‡¶® ‡¶™‡ßç‡¶∞‡¶¶‡¶æ‡¶®</h3><p class="amount" id="dashTotalOnudan" style="color: var(--warning);">‡ß¶ ‡ß≥</p></div>
            </div>
            <div class="section-title"><span id="txtRecent" class="editable" onclick="editUIText('txtRecent')">‡¶∏‡¶æ‡¶Æ‡ßç‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶ï ‡¶≤‡ßá‡¶®‡¶¶‡ßá‡¶®</span></div>
            <div class="list-container"><table><tbody id="recentActivityTable"></tbody></table></div>
        </div>

        <div id="members" class="page-section">
            <div class="section-title"><span id="txtMemList" class="editable" onclick="editUIText('txtMemList')">‡¶∏‡¶¶‡¶∏‡ßç‡¶Ø‡¶¶‡ßá‡¶∞ ‡¶§‡¶æ‡¶≤‡¶ø‡¶ï‡¶æ</span></div>
            <div class="list-container">
                <table><thead><tr><th style="text-align:left;">‡¶®‡¶æ‡¶Æ</th><th style="text-align:center;">‡¶Æ‡ßã‡¶ü ‡¶ú‡¶Æ‡¶æ</th><th style="text-align:right;">‡¶¨‡¶∞‡ßç‡¶§‡¶Æ‡¶æ‡¶® ‡¶ã‡¶£</th></tr></thead><tbody id="membersTable"></tbody></table>
            </div>
        </div>

        <div id="onudan" class="page-section">
            <div class="section-title"><span id="txtDonList" class="editable" onclick="editUIText('txtDonList')">‡¶Ö‡¶®‡ßÅ‡¶¶‡¶æ‡¶® ‡¶á‡¶§‡¶ø‡¶π‡¶æ‡¶∏</span></div>
            <div class="list-container">
                <table><thead><tr><th style="text-align:left;">‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ ‡¶ì ‡¶ó‡ßç‡¶∞‡¶π‡ßÄ‡¶§‡¶æ</th><th style="text-align:right;">‡¶™‡¶∞‡¶ø‡¶Æ‡¶æ‡¶£</th><th class="admin-only" style="text-align:right;">‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ï‡¶∂‡¶®</th></tr></thead><tbody id="donationsTable"></tbody></table>
            </div>
        </div>

        <div id="events" class="page-section">
            <div class="section-title"><span id="txtEvtList" class="editable" onclick="editUIText('txtEvtList')">‡¶Ö‡¶®‡ßÅ‡¶∑‡ßç‡¶†‡¶æ‡¶® ‡¶Ü‡ßü-‡¶¨‡ßç‡¶Ø‡ßü</span></div>
            <div class="list-container">
                <table><thead><tr><th style="text-align:left;">‡¶Ö‡¶®‡ßÅ‡¶∑‡ßç‡¶†‡¶æ‡¶® ‡¶ì ‡¶¨‡¶ø‡¶¨‡¶∞‡¶£</th><th style="text-align:right;">‡¶™‡¶∞‡¶ø‡¶Æ‡¶æ‡¶£</th><th class="admin-only" style="text-align:right;">‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ï‡¶∂‡¶®</th></tr></thead><tbody id="eventsTable"></tbody></table>
            </div>
        </div>
    </div>

    <div class="bottom-nav">
        <div class="nav-item active" onclick="switchTab('dashboard', this)"><div class="nav-icon"><i class="fas fa-home"></i></div><span>‡¶π‡ßã‡¶Æ</span></div>
        <div class="nav-item" onclick="switchTab('members', this)"><div class="nav-icon"><i class="fas fa-users"></i></div><span>‡¶∏‡¶¶‡¶∏‡ßç‡¶Ø</span></div>
        <div class="fab-wrapper"><button class="fab-btn" onclick="openQuickAction()"><i class="fas fa-plus"></i></button></div>
        <div class="nav-item" onclick="switchTab('onudan', this)"><div class="nav-icon"><i class="fas fa-hands-helping"></i></div><span>‡¶Ö‡¶®‡ßÅ‡¶¶‡¶æ‡¶®</span></div>
        <div class="nav-item" onclick="switchTab('events', this)"><div class="nav-icon"><i class="fas fa-calendar-alt"></i></div><span>‡¶Ö‡¶®‡ßÅ‡¶∑‡ßç‡¶†‡¶æ‡¶®</span></div>
    </div>

    <div id="quickActionModal" class="modal-overlay">
        <div class="modal-content" style="padding-bottom: 30px;">
            <button class="close-btn" onclick="closeModal('quickActionModal')">&times;</button>
            <h2 style="margin: 0 0 15px; font-size: 18px; color: var(--nav-bg);">‡¶®‡¶§‡ßÅ‡¶® ‡¶∞‡ßá‡¶ï‡¶∞‡ßç‡¶° ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡ßÅ‡¶®</h2>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                <div style="background: #f8fafc; padding: 15px; border-radius: 12px; text-align: center; cursor: pointer;" onclick="closeModal('quickActionModal'); openModal('addMemberModal')"><div style="font-size: 24px; margin-bottom: 5px; color: var(--primary);"><i class="fas fa-user-plus"></i></div><div style="font-size: 12px; font-weight: 500;">‡¶®‡¶§‡ßÅ‡¶® ‡¶∏‡¶¶‡¶∏‡ßç‡¶Ø</div></div>
                <div style="background: #f8fafc; padding: 15px; border-radius: 12px; text-align: center; cursor: pointer;" onclick="closeModal('quickActionModal'); document.getElementById('donDate').value = getIsoToday(); openModal('addDonationModal')"><div style="font-size: 24px; margin-bottom: 5px; color: var(--warning);"><i class="fas fa-gift"></i></div><div style="font-size: 12px; font-weight: 500;">‡¶Ö‡¶®‡ßÅ‡¶¶‡¶æ‡¶® ‡¶¶‡¶ø‡¶®</div></div>
                <div style="background: #f8fafc; padding: 15px; border-radius: 12px; text-align: center; cursor: pointer;" onclick="closeModal('quickActionModal'); document.getElementById('eventDate').value = getIsoToday(); openModal('addEventModal')"><div style="font-size: 24px; margin-bottom: 5px; color: var(--info);"><i class="fas fa-calendar-plus"></i></div><div style="font-size: 12px; font-weight: 500;">‡¶Ö‡¶®‡ßÅ‡¶∑‡ßç‡¶†‡¶æ‡¶® ‡¶π‡¶ø‡¶∏‡¶æ‡¶¨</div></div>
            </div>
        </div>
    </div>

    <div id="loginModal" class="modal-overlay">
        <div class="modal-content">
            <button class="close-btn" onclick="closeModal('loginModal')">&times;</button>
            <div id="loginFormArea">
                <div style="text-align: center; font-size: 35px; margin-bottom: 5px; color: var(--primary);"><i class="fas fa-user-shield"></i></div>
                <h2 style="margin: 0 0 15px; text-align: center; font-size: 18px;">‡¶Ö‡ßç‡¶Ø‡¶æ‡¶°‡¶Æ‡¶ø‡¶® ‡¶≤‡¶ó‡¶á‡¶®</h2>
                <div class="input-group"><label>‡¶á‡¶â‡¶ú‡¶æ‡¶∞‡¶®‡ßá‡¶Æ</label><input type="text" id="adminUser" placeholder="‡¶á‡¶â‡¶ú‡¶æ‡¶∞‡¶®‡ßá‡¶Æ ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®"></div>
                <div class="input-group"><label>‡¶™‡¶æ‡¶∏‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶°</label><input type="password" id="adminPass" placeholder="‡¶™‡¶æ‡¶∏‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶° ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®"></div>
                <button class="btn-app btn-primary" onclick="loginAdmin()">‡¶™‡ßç‡¶∞‡¶¨‡ßá‡¶∂ ‡¶ï‡¶∞‡ßÅ‡¶®</button>
            </div>
            <div id="logoutFormArea" style="display: none; text-align: center;">
                <div style="font-size: 40px; margin-bottom: 10px; color: var(--danger);"><i class="fas fa-sign-out-alt"></i></div>
                <h2 style="margin: 0 0 15px; font-size: 18px;">‡¶Ö‡ßç‡¶Ø‡¶æ‡¶°‡¶Æ‡¶ø‡¶® ‡¶™‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶≤</h2>
                <button class="btn-app btn-info" onclick="openCredChangeModal()" style="margin-bottom: 10px;"><i class="fas fa-cog"></i> ‡¶™‡¶æ‡¶∏‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶° ‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®</button>
                <button class="btn-app btn-danger" onclick="logoutAdmin()"><i class="fas fa-power-off"></i> ‡¶≤‡¶ó‡¶Ü‡¶â‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®</button>
            </div>
        </div>
    </div>

    <div id="changeCredModal" class="modal-overlay" style="z-index: 1005;">
        <div class="modal-content">
            <button class="close-btn" onclick="closeModal('changeCredModal')">&times;</button>
            <h2 style="margin: 0 0 15px; font-size: 16px; color: var(--nav-bg);"><i class="fas fa-key"></i> ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶°‡¶Æ‡¶ø‡¶® ‡¶§‡¶•‡ßç‡¶Ø ‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶®</h2>
            <div class="input-group"><label>‡¶®‡¶§‡ßÅ‡¶® ‡¶á‡¶â‡¶ú‡¶æ‡¶∞‡¶®‡ßá‡¶Æ</label><input type="text" id="newAdminUser"></div>
            <div class="input-group"><label>‡¶®‡¶§‡ßÅ‡¶® ‡¶™‡¶æ‡¶∏‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶°</label><input type="password" id="newAdminPass"></div>
            <button class="btn-app btn-primary" onclick="saveNewCredentials()">‡¶∏‡ßá‡¶≠ ‡¶ï‡¶∞‡ßÅ‡¶®</button>
        </div>
    </div>

    <div id="memberProfileModal" class="modal-overlay">
        <div class="modal-content">
            <button class="close-btn" onclick="closeModal('memberProfileModal')">&times;</button>
            <div class="profile-header">
                <div style="position: relative; display: inline-block;">
                    <img id="profImage" class="avatar-lg" src="">
                    <label class="admin-only edit-photo-badge" title="‡¶õ‡¶¨‡¶ø ‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®" onclick="clickProfilePhotoUpload()"><i class="fas fa-pen"></i></label>
                    <input type="file" id="editProfilePhoto" accept="image/*" style="display:none;" onchange="updateProfilePhoto(this)">
                </div>
                <h2 id="profName" style="margin: 5px 0 2px; font-size: 18px;">‡¶®‡¶æ‡¶Æ</h2>
                <p style="margin: 0; color: var(--text-muted); font-size: 11px;">‡¶Ø‡ßã‡¶ó‡¶¶‡¶æ‡¶®: <span id="profDate"></span></p>
            </div>
            
            <div class="profile-stats">
                <div class="stat-box deposit"><span id="profTotalKisti" style="color:var(--success);">‡ß¶ ‡ß≥</span><small>‡¶Æ‡ßã‡¶ü ‡¶ú‡¶Æ‡¶æ</small></div>
                <div class="stat-box loan"><span id="profTotalLoan" style="color:var(--danger);">‡ß¶ ‡ß≥</span><small>‡¶¨‡¶∞‡ßç‡¶§‡¶Æ‡¶æ‡¶® ‡¶ã‡¶£</small></div>
            </div>
            
            <div class="admin-only-flex" style="margin-bottom: 15px; gap: 10px; width: 100%;">
                <button class="btn-app btn-success" style="margin:0; flex: 1; padding: 12px; font-size: 13px;" onclick="openKistiModal()">+ ‡¶ï‡¶ø‡¶∏‡ßç‡¶§‡¶ø ‡¶ú‡¶Æ‡¶æ</button>
                <button class="btn-app btn-danger" style="margin:0; flex: 1; padding: 12px; font-size: 13px;" onclick="openLoanModal()">+ ‡¶ã‡¶£ ‡¶™‡ßç‡¶∞‡¶¶‡¶æ‡¶®</button>
            </div>

            <h3 style="font-size: 13px; margin-bottom: 8px; color: var(--nav-bg);">‡¶≤‡ßá‡¶®‡¶¶‡ßá‡¶®‡ßá‡¶∞ ‡¶¨‡¶ø‡¶¨‡¶∞‡¶£:</h3>
            <div style="max-height: 180px; overflow-y: auto; border: 1px solid #f1f5f9; border-radius: 12px;">
                <table class="compact-table" style="width: 100%;">
                    <thead><tr><th style="text-align: left;">‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ ‡¶ì ‡¶¨‡¶ø‡¶¨‡¶∞‡¶£</th><th style="text-align: center;">‡¶ñ‡¶æ‡¶§</th><th style="text-align: right;">‡¶™‡¶∞‡¶ø‡¶Æ‡¶æ‡¶£</th><th class="admin-only" style="text-align: right; padding-right: 10px;">‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ï‡¶∂‡¶®</th></tr></thead>
                    <tbody id="profHistoryTable"></tbody>
                </table>
            </div>
        </div>
    </div>

    <div id="addMemberModal" class="modal-overlay"><div class="modal-content"><button class="close-btn" onclick="closeModal('addMemberModal')">&times;</button><h2 style="margin: 0 0 15px; font-size: 16px;">‡¶®‡¶§‡ßÅ‡¶® ‡¶∏‡¶¶‡¶∏‡ßç‡¶Ø</h2><div class="input-group"><label>‡¶õ‡¶¨‡¶ø (‡¶ê‡¶ö‡ßç‡¶õ‡¶ø‡¶ï)</label><input type="file" id="newMemberPhoto" accept="image/*"></div><div class="input-group"><label>‡¶®‡¶æ‡¶Æ</label><input type="text" id="newMemberName"></div><div class="input-group"><label>‡¶Ø‡ßã‡¶ó‡¶¶‡¶æ‡¶®‡ßá‡¶∞ ‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ</label><input type="date" id="newMemberDate"></div><button class="btn-app btn-primary" onclick="addNewMember()">‡¶∏‡ßá‡¶≠ ‡¶ï‡¶∞‡ßÅ‡¶®</button></div></div>
    <div id="kistiModal" class="modal-overlay"><div class="modal-content"><button class="close-btn" onclick="closeModal('kistiModal')">&times;</button><h2 style="margin: 0 0 15px; font-size: 16px; color:var(--success);">‡¶ï‡¶ø‡¶∏‡ßç‡¶§‡¶ø ‡¶ú‡¶Æ‡¶æ</h2><div class="input-group"><label>‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ</label><input type="date" id="kistiDate"></div><div class="input-group"><label>‡¶™‡¶∞‡¶ø‡¶Æ‡¶æ‡¶£</label><input type="number" id="kistiAmount" value="2000"></div><button class="btn-app btn-success" onclick="submitKisti()">‡¶®‡¶ø‡¶∂‡ßç‡¶ö‡¶ø‡¶§ ‡¶ï‡¶∞‡ßÅ‡¶®</button></div></div>
    <div id="loanModal" class="modal-overlay"><div class="modal-content"><button class="close-btn" onclick="closeModal('loanModal')">&times;</button><h2 style="margin: 0 0 15px; font-size: 16px; color:var(--danger);">‡¶ã‡¶£ ‡¶™‡ßç‡¶∞‡¶¶‡¶æ‡¶®</h2><div class="input-group"><label>‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ</label><input type="date" id="loanDate"></div><div class="input-group"><label>‡¶™‡¶∞‡¶ø‡¶Æ‡¶æ‡¶£</label><select id="loanAmount"><option value="50000">‡ß´‡ß¶,‡ß¶‡ß¶‡ß¶ ‡ß≥</option><option value="100000">‡ßß,‡ß¶‡ß¶,‡ß¶‡ß¶‡ß¶ ‡ß≥</option></select></div><button class="btn-app btn-danger" onclick="submitLoan()">‡¶ï‡¶®‡¶´‡¶æ‡¶∞‡ßç‡¶Æ ‡¶ï‡¶∞‡ßÅ‡¶®</button></div></div>
    <div id="addDonationModal" class="modal-overlay"><div class="modal-content"><button class="close-btn" onclick="closeModal('addDonationModal')">&times;</button><h2 style="margin: 0 0 15px; font-size: 16px; color:var(--warning);">‡¶®‡¶§‡ßÅ‡¶® ‡¶Ö‡¶®‡ßÅ‡¶¶‡¶æ‡¶®</h2><div class="input-group"><label>‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ</label><input type="date" id="donDate"></div><div class="input-group"><label>‡¶ó‡ßç‡¶∞‡¶π‡ßÄ‡¶§‡¶æ</label><input type="text" id="donName"></div><div class="input-group"><label>‡¶ï‡¶æ‡¶∞‡¶£</label><input type="text" id="donReason"></div><div class="input-group"><label>‡¶™‡¶∞‡¶ø‡¶Æ‡¶æ‡¶£</label><input type="number" id="donAmount"></div><button class="btn-app" style="background:var(--warning)" onclick="addNewDonation()">‡¶™‡ßç‡¶∞‡¶¶‡¶æ‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®</button></div></div>
    <div id="addEventModal" class="modal-overlay"><div class="modal-content"><button class="close-btn" onclick="closeModal('addEventModal')">&times;</button><h2 style="margin: 0 0 15px; font-size: 16px; color:var(--info);">‡¶Ö‡¶®‡ßÅ‡¶∑‡ßç‡¶†‡¶æ‡¶® ‡¶π‡¶ø‡¶∏‡¶æ‡¶¨</h2><div class="input-group"><label>‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ</label><input type="date" id="eventDate"></div><div class="input-group"><label>‡¶®‡¶æ‡¶Æ</label><input type="text" id="eventName"></div><div class="input-group"><label>‡¶¨‡¶ø‡¶¨‡¶∞‡¶£</label><input type="text" id="eventDesc"></div><div class="input-group"><label>‡¶ñ‡¶æ‡¶§</label><select id="eventType"><option value="‡¶Ü‡ßü">‡¶Ü‡ßü (+)</option><option value="‡¶¨‡ßç‡¶Ø‡ßü">‡¶¨‡ßç‡¶Ø‡ßü (-)</option></select></div><div class="input-group"><label>‡¶™‡¶∞‡¶ø‡¶Æ‡¶æ‡¶£</label><input type="number" id="eventAmount"></div><button class="btn-app btn-info" onclick="saveEventData()">‡¶∏‡ßá‡¶≠ ‡¶ï‡¶∞‡ßÅ‡¶®</button></div></div>
    <div id="editUniversalModal" class="modal-overlay"><div class="modal-content"><button class="close-btn" onclick="closeModal('editUniversalModal')">&times;</button><h2 style="margin: 0 0 15px; font-size: 16px;">‡¶π‡¶ø‡¶∏‡¶æ‡¶¨ ‡¶è‡¶°‡¶ø‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®</h2><div class="input-group" id="editNameGroup"><label>‡¶®‡¶æ‡¶Æ</label><input type="text" id="editUName"></div><div class="input-group" id="editDescGroup"><label>‡¶¨‡¶ø‡¶¨‡¶∞‡¶£</label><input type="text" id="editUDesc"></div><div class="input-group"><label>‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ</label><input type="date" id="editUDate"></div><div class="input-group"><label>‡¶™‡¶∞‡¶ø‡¶Æ‡¶æ‡¶£</label><input type="number" id="editUAmount"></div><button class="btn-app btn-primary" onclick="saveEditedUniversal()">‡¶∏‡ßá‡¶≠ ‡¶ï‡¶∞‡ßÅ‡¶®</button></div></div>

    <script>
        // ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶¶‡ßá‡¶ì‡ßü‡¶æ ‡¶Ü‡¶∏‡¶≤ Firebase Config
        const firebaseConfig = {
            apiKey: "AIzaSyAtOtkK97hcpdraUiRIN3u_c4uN2K_v3e0",
            authDomain: "club-app-f25c8.firebaseapp.com",
            databaseURL: "https://club-app-f25c8-default-rtdb.firebaseio.com",
            projectId: "club-app-f25c8",
            storageBucket: "club-app-f25c8.firebasestorage.app",
            messagingSenderId: "41305793806",
            appId: "1:41305793806:web:5f5f8efded5384ca0e235f"
        };
        
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();

        const placeholderImg = "https://ui-avatars.com/api/?background=2b4266&color=fff&size=128&bold=true&name=";
        
        // ‡¶≤‡¶ó‡¶á‡¶® ‡¶∏‡ßá‡¶∂‡¶® ‡¶Æ‡¶®‡ßá ‡¶∞‡¶æ‡¶ñ‡¶æ‡¶∞ ‡¶¨‡ßç‡¶Ø‡¶¨‡¶∏‡ßç‡¶•‡¶æ (‡¶∞‡¶ø‡¶≤‡ßã‡¶° ‡¶¶‡¶ø‡¶≤‡ßá ‡¶≤‡¶ó‡¶Ü‡¶â‡¶ü ‡¶π‡¶¨‡ßá ‡¶®‡¶æ)
        let isAdmin = localStorage.getItem('clubAdminLoggedIn') === 'true';
        let isEditMode = false;

        let members = []; let donations = []; let clubEvents = [];
        let uiTexts = { txtClubName: "‡¶Ü‡¶Æ‡¶æ‡¶¶‡ßá‡¶∞ ‡¶ï‡ßç‡¶≤‡¶æ‡¶¨", txtDashTitle: "‡¶°‡ßç‡¶Ø‡¶æ‡¶∂‡¶¨‡ßã‡¶∞‡ßç‡¶°", txtDashSub: "‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶ï‡ßç‡¶≤‡¶æ‡¶¨‡ßá‡¶∞ ‡¶π‡¶ø‡¶∏‡¶æ‡¶¨ ‡¶è‡¶ï ‡¶®‡¶ú‡¶∞‡ßá ‡¶¶‡ßá‡¶ñ‡ßÅ‡¶®", txtCard1: "‡¶Æ‡ßã‡¶ü ‡¶´‡¶æ‡¶®‡ßç‡¶° (‡¶∏‡¶Ç‡¶ó‡ßç‡¶∞‡¶π)", txtCard2: "‡¶¨‡¶∞‡ßç‡¶§‡¶Æ‡¶æ‡¶® ‡¶ï‡ßç‡¶Ø‡¶æ‡¶∂", txtCard3: "‡¶∏‡¶¶‡¶∏‡ßç‡¶Ø‡¶¶‡ßá‡¶∞ ‡¶ã‡¶£", txtCard4: "‡¶Ö‡¶®‡ßÅ‡¶¶‡¶æ‡¶® ‡¶™‡ßç‡¶∞‡¶¶‡¶æ‡¶®", txtRecent: "‡¶∏‡¶æ‡¶Æ‡ßç‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶ï ‡¶≤‡ßá‡¶®‡¶¶‡ßá‡¶®", txtMemList: "‡¶∏‡¶¶‡¶∏‡ßç‡¶Ø‡¶¶‡ßá‡¶∞ ‡¶§‡¶æ‡¶≤‡¶ø‡¶ï‡¶æ", txtDonList: "‡¶Ö‡¶®‡ßÅ‡¶¶‡¶æ‡¶® ‡¶á‡¶§‡¶ø‡¶π‡¶æ‡¶∏", txtEvtList: "‡¶Ö‡¶®‡ßÅ‡¶∑‡ßç‡¶†‡¶æ‡¶® ‡¶Ü‡ßü-‡¶¨‡ßç‡¶Ø‡ßü" };
        let savedLogo = "https://ui-avatars.com/api/?background=3b82f6&color=fff&bold=true&name=C";
        
        let savedAdminUser = 'admin'; let savedAdminPass = '12345';

        let activeMemberId = null; let editType = null; let editTargetId = null;
        let confirmCallback = null; let promptCallback = null;

        function formatMoney(amount) { return amount.toLocaleString('en-IN') + " ‡ß≥"; }
        function getIsoToday() { let d = new Date(); d.setMinutes(d.getMinutes() - d.getTimezoneOffset()); return d.toISOString().split('T')[0]; }
        function formatDateBangla(dStr) { return new Date(dStr || new Date()).toLocaleDateString('bn-BD', { day: 'numeric', month: 'short', year: 'numeric' }); }

        function saveData() {
            db.ref('clubData').set({
                members: members, donations: donations, clubEvents: clubEvents,
                uiTexts: uiTexts, savedLogo: savedLogo, savedAdminUser: savedAdminUser, savedAdminPass: savedAdminPass
            });
        }

        let isFirstLoad = true;
        db.ref('clubData').on('value', (snapshot) => {
            const data = snapshot.val();
            if (data) {
                members = data.members || []; donations = data.donations || []; clubEvents = data.clubEvents || [];
                if(data.uiTexts) uiTexts = data.uiTexts;
                if(data.savedLogo) savedLogo = data.savedLogo;
                if(data.savedAdminUser) savedAdminUser = data.savedAdminUser;
                if(data.savedAdminPass) savedAdminPass = data.savedAdminPass;
            }
            document.getElementById('mainClubLogo').src = savedLogo;
            for (let key in uiTexts) { if(document.getElementById(key)) document.getElementById(key).innerText = uiTexts[key]; }
            document.title = uiTexts.txtClubName || "‡¶Ü‡¶Æ‡¶æ‡¶¶‡ßá‡¶∞ ‡¶ï‡ßç‡¶≤‡¶æ‡¶¨";
            
            renderUI();

            if(isFirstLoad) {
                setTimeout(() => { document.getElementById('startupLoader').style.opacity = '0'; setTimeout(() => document.getElementById('startupLoader').style.display = 'none', 400); }, 500);
                
                // ‡¶∞‡¶ø‡¶≤‡ßã‡¶° ‡¶¶‡ßá‡¶ì‡ßü‡¶æ‡¶∞ ‡¶™‡¶∞ ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶°‡¶Æ‡¶ø‡¶® ‡¶∏‡ßá‡¶∂‡¶® ‡¶∞‡¶ø‡¶∏‡ßç‡¶ü‡ßã‡¶∞ ‡¶ï‡¶∞‡¶æ
                if(isAdmin) {
                    document.body.classList.add('admin-mode'); 
                    const loginBtn = document.getElementById('mainLoginBtn');
                    if (loginBtn) {
                        loginBtn.innerHTML = '<i class="fas fa-lock-open"></i> LOGOUT';
                        loginBtn.classList.add('logged-in');
                    }
                }
                
                isFirstLoad = false;
            }
        });

        function processAction(callback, loadingText = '‡¶™‡ßç‡¶∞‡¶∏‡ßá‡¶∏‡¶ø‡¶Ç ‡¶π‡¶ö‡ßç‡¶õ‡ßá...') {
            document.getElementById('actionLoaderText').innerText = loadingText;
            document.getElementById('actionLoader').classList.add('active');
            setTimeout(() => { callback(); saveData(); document.getElementById('actionLoader').classList.remove('active'); }, 800);
        }

        // ================= ‡¶ï‡¶æ‡¶∏‡ßç‡¶ü‡¶Æ ‡¶™‡¶™-‡¶Ü‡¶™ =================
        function showCustomAlert(msg) { document.getElementById('customAlertMsg').innerText = msg; document.getElementById('customAlert').classList.add('active'); }
        function closeCustomAlert() { document.getElementById('customAlert').classList.remove('active'); }
        function showCustomConfirm(msg, callback) { document.getElementById('customConfirmMsg').innerText = msg; confirmCallback = callback; document.getElementById('customConfirm').classList.add('active'); }
        function closeCustomConfirm(res) { document.getElementById('customConfirm').classList.remove('active'); if(confirmCallback) confirmCallback(res); }
        function showCustomPrompt(msg, defaultVal, callback) { document.getElementById('customPromptMsg').innerText = msg; document.getElementById('customPromptInput').value = defaultVal || ''; promptCallback = callback; document.getElementById('customPrompt').classList.add('active'); }
        function closeCustomPrompt(val) { document.getElementById('customPrompt').classList.remove('active'); if(promptCallback) promptCallback(val); }
        function submitCustomPrompt() { closeCustomPrompt(document.getElementById('customPromptInput').value); }

        // ================= ‡¶Ö‡¶®‡¶≤‡¶æ‡¶á‡¶® ‡¶≤‡¶ó‡¶á‡¶® ‡¶∏‡¶ø‡¶∏‡ßç‡¶ü‡ßá‡¶Æ =================
        function openAdminLogin() {
            if(isAdmin) { document.getElementById('loginFormArea').style.display = 'none'; document.getElementById('logoutFormArea').style.display = 'block'; } 
            else { document.getElementById('loginFormArea').style.display = 'block'; document.getElementById('logoutFormArea').style.display = 'none'; }
            openModal('loginModal');
        }

        function loginAdmin() {
            let u = document.getElementById('adminUser').value; let p = document.getElementById('adminPass').value;
            if(u === savedAdminUser && p === savedAdminPass) {
                processAction(() => { 
                    isAdmin = true; 
                    localStorage.setItem('clubAdminLoggedIn', 'true'); // ‡¶∏‡ßá‡¶∂‡¶® ‡¶∏‡ßá‡¶≠ ‡¶ï‡¶∞‡¶æ ‡¶π‡¶≤‡ßã
                    document.body.classList.add('admin-mode'); 
                    const loginBtn = document.getElementById('mainLoginBtn');
                    loginBtn.innerHTML = '<i class="fas fa-lock-open"></i> LOGOUT';
                    loginBtn.classList.add('logged-in');
                    closeModal('loginModal'); showCustomAlert('‡¶Ö‡ßç‡¶Ø‡¶æ‡¶°‡¶Æ‡¶ø‡¶® ‡¶™‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶≤ ‡¶ö‡¶æ‡¶≤‡ßÅ ‡¶π‡ßü‡ßá‡¶õ‡ßá‡•§'); 
                }, "‡¶≤‡¶ó‡¶á‡¶® ‡¶≠‡ßá‡¶∞‡¶ø‡¶´‡¶æ‡¶á ‡¶ï‡¶∞‡¶æ ‡¶π‡¶ö‡ßç‡¶õ‡ßá...");
            } else { processAction(() => { showCustomAlert('‡¶á‡¶â‡¶ú‡¶æ‡¶∞‡¶®‡ßá‡¶Æ ‡¶¨‡¶æ ‡¶™‡¶æ‡¶∏‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶° ‡¶≠‡ßÅ‡¶≤ ‡¶π‡ßü‡ßá‡¶õ‡ßá!'); }, "‡¶≠‡ßá‡¶∞‡¶ø‡¶´‡¶æ‡¶á ‡¶ï‡¶∞‡¶æ ‡¶π‡¶ö‡ßç‡¶õ‡ßá..."); }
        }
        
        function logoutAdmin() {
            processAction(() => { 
                isAdmin = false; isEditMode = false;
                localStorage.removeItem('clubAdminLoggedIn'); // ‡¶∏‡ßá‡¶∂‡¶® ‡¶Æ‡ßÅ‡¶õ‡ßá ‡¶´‡ßá‡¶≤‡¶æ ‡¶π‡¶≤‡ßã
                document.body.classList.remove('admin-mode'); document.body.classList.remove('edit-mode');
                document.getElementById('editModeToggle').checked = false; 
                const loginBtn = document.getElementById('mainLoginBtn');
                loginBtn.innerHTML = '<i class="fas fa-lock"></i> LOGIN';
                loginBtn.classList.remove('logged-in');
                document.getElementById('adminPass').value = ''; document.getElementById('adminUser').value = '';
                closeModal('loginModal'); showCustomAlert('‡¶≤‡¶ó‡¶Ü‡¶â‡¶ü ‡¶∏‡¶Æ‡ßç‡¶™‡¶®‡ßç‡¶® ‡¶π‡ßü‡ßá‡¶õ‡ßá‡•§'); 
            }, "‡¶≤‡¶ó‡¶Ü‡¶â‡¶ü ‡¶ï‡¶∞‡¶æ ‡¶π‡¶ö‡ßç‡¶õ‡ßá...");
        }

        function toggleEditMode() {
            if (!isAdmin) { document.getElementById('editModeToggle').checked = false; showCustomAlert("‡¶è‡¶°‡¶ø‡¶ü ‡¶Æ‡ßã‡¶° ‡¶ö‡¶æ‡¶≤‡ßÅ ‡¶ï‡¶∞‡¶§‡ßá ‡¶™‡ßç‡¶∞‡¶•‡¶Æ‡ßá ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶°‡¶Æ‡¶ø‡¶® ‡¶≤‡¶ó‡¶á‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®‡•§"); return; }
            isEditMode = document.getElementById('editModeToggle').checked;
            if (isEditMode) { document.body.classList.add('edit-mode'); showCustomAlert('‡¶è‡¶°‡¶ø‡¶ü ‡¶Æ‡ßã‡¶° ‡¶ö‡¶æ‡¶≤‡ßÅ ‡¶π‡ßü‡ßá‡¶õ‡ßá! ‡¶è‡¶ñ‡¶® ‡¶Ü‡¶™‡¶®‡¶ø ‡¶ì‡ßü‡ßá‡¶¨‡¶∏‡¶æ‡¶á‡¶ü‡ßá‡¶∞ ‡¶Ø‡ßá‡¶ï‡ßã‡¶®‡ßã ‡¶≤‡ßá‡¶ñ‡¶æ‡ßü ‡¶ï‡ßç‡¶≤‡¶ø‡¶ï ‡¶ï‡¶∞‡ßá ‡¶§‡¶æ ‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶® ‡¶ï‡¶∞‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡¶¨‡ßá‡¶®‡•§'); } 
            else { document.body.classList.remove('edit-mode'); showCustomAlert('‡¶è‡¶°‡¶ø‡¶ü ‡¶Æ‡ßã‡¶° ‡¶¨‡¶®‡ßç‡¶ß ‡¶ï‡¶∞‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá‡•§'); }
        }

        function openCredChangeModal() { closeModal('loginModal'); document.getElementById('newAdminUser').value = savedAdminUser; document.getElementById('newAdminPass').value = ''; openModal('changeCredModal'); }
        function saveNewCredentials() {
            if (!isAdmin) return;
            let nU = document.getElementById('newAdminUser').value; let nP = document.getElementById('newAdminPass').value;
            if(nU.trim() !== "" && nP.trim() !== "") {
                processAction(() => { savedAdminUser = nU.trim(); savedAdminPass = nP.trim(); closeModal('changeCredModal'); showCustomAlert('‡¶á‡¶â‡¶ú‡¶æ‡¶∞‡¶®‡ßá‡¶Æ ‡¶ì ‡¶™‡¶æ‡¶∏‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶° ‡¶∏‡¶´‡¶≤‡¶≠‡¶æ‡¶¨‡ßá ‡¶Ü‡¶™‡¶°‡ßá‡¶ü ‡¶π‡ßü‡ßá‡¶õ‡ßá!'); }, "‡¶Ü‡¶™‡¶°‡ßá‡¶ü ‡¶π‡¶ö‡ßç‡¶õ‡ßá...");
            } else { showCustomAlert("‡¶∏‡¶†‡¶ø‡¶ï ‡¶§‡¶•‡ßç‡¶Ø ‡¶¶‡¶ø‡¶®!"); }
        }

        function editUIText(elementId) {
            if(!isAdmin || !isEditMode) return;
            let currentText = document.getElementById(elementId).innerText;
            showCustomPrompt("‡¶®‡¶§‡ßÅ‡¶® ‡¶≤‡ßá‡¶ñ‡¶æ ‡¶¶‡¶ø‡¶®:", currentText, function(newText) {
                if(newText && newText.trim() !== "") { uiTexts[elementId] = newText.trim(); document.getElementById(elementId).innerText = newText.trim(); saveData(); }
            });
        }

        function clickLogoUpload() { if(isAdmin && isEditMode) { document.getElementById('clubLogoUpload').click(); } else if (isAdmin) { showCustomAlert("‡¶≤‡ßã‡¶ó‡ßã ‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶® ‡¶ï‡¶∞‡¶§‡ßá ‡¶â‡¶™‡¶∞‡ßá ‡¶°‡¶æ‡¶®‡¶¶‡¶ø‡¶ï‡ßá‡¶∞ '‡¶è‡¶°‡¶ø‡¶ü ‡¶Æ‡ßã‡¶°' ‡¶ö‡¶æ‡¶≤‡ßÅ ‡¶ï‡¶∞‡ßÅ‡¶®‡•§"); } }
        function clickProfilePhotoUpload() { if(isAdmin && isEditMode) { document.getElementById('editProfilePhoto').click(); } else if (isAdmin) { showCustomAlert("‡¶õ‡¶¨‡¶ø ‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶® ‡¶ï‡¶∞‡¶§‡ßá ‡¶â‡¶™‡¶∞‡ßá ‡¶°‡¶æ‡¶®‡¶¶‡¶ø‡¶ï‡ßá‡¶∞ '‡¶è‡¶°‡¶ø‡¶ü ‡¶Æ‡ßã‡¶°' ‡¶ö‡¶æ‡¶≤‡ßÅ ‡¶ï‡¶∞‡ßÅ‡¶®‡•§"); } }
        function updateClubLogo(input) { if(!isAdmin) return; if(input.files && input.files[0]) { processAction(() => { let r = new FileReader(); r.onload = e => { savedLogo = e.target.result; document.getElementById('mainClubLogo').src = savedLogo; }; r.readAsDataURL(input.files[0]); }, "‡¶≤‡ßã‡¶ó‡ßã ‡¶Ü‡¶™‡¶°‡ßá‡¶ü ‡¶π‡¶ö‡ßç‡¶õ‡ßá..."); } }
        function updateProfilePhoto(input) { if(!isAdmin) return; if(input.files && input.files[0]) { processAction(() => { let r = new FileReader(); r.onload = e => { let m = members.find(x => x.id === activeMemberId); m.img = e.target.result; document.getElementById('profImage').src = m.img; renderUI(); }; r.readAsDataURL(input.files[0]); }, "‡¶õ‡¶¨‡¶ø ‡¶Ü‡¶™‡¶°‡ßá‡¶ü ‡¶π‡¶ö‡ßç‡¶õ‡ßá..."); } }

        function renderUI() {
            let totalFund = 0; let totalLoanGiven = 0; let totalDonation = 0; let eventIncome = 0; let eventExpense = 0;
            let mHtml = ''; let dHtml = ''; let eHtml = ''; let recentActs = [];

            members.forEach(m => {
                m.totalKisti = 0; m.totalLoan = 0;
                if(m.history) { m.history.forEach(h => { if(h.type === "‡¶ï‡¶ø‡¶∏‡ßç‡¶§‡¶ø ‡¶ú‡¶Æ‡¶æ") m.totalKisti += h.amount; if(h.type === "‡¶ã‡¶£ ‡¶ó‡ßç‡¶∞‡¶π‡¶£") m.totalLoan += h.amount; }); }
                totalFund += m.totalKisti; totalLoanGiven += m.totalLoan;
                
                mHtml += `<tr><td style="text-align:left;"><div class="clickable-name" onclick="openProfile(${m.id})"><img src="${m.img}" class="avatar-sm"> <span>${m.name}</span></div></td><td style="color: var(--success); font-weight: 600; text-align:center;">${formatMoney(m.totalKisti)}</td><td style="color: var(--danger); font-weight: 600; text-align:right;">${formatMoney(m.totalLoan)}</td></tr>`;
                if(m.history) { m.history.forEach(h => recentActs.push({date: h.date, rawDate: h.rawDate, name: m.name, type: h.type, amount: h.amount, color: h.color})); }
            });
            document.getElementById('membersTable').innerHTML = mHtml;

            donations.forEach(d => {
                totalDonation += d.amount;
                dHtml += `<tr><td style="text-align:left;"><div style="font-weight:600; color:var(--nav-bg);">${d.name}</div><div style="font-size:10px; color:var(--text-muted);">${d.date}</div></td><td style="color: var(--warning); font-weight: 600; text-align:right;">${formatMoney(d.amount)}</td><td class="admin-only" style="text-align: right;"><button class="action-icon" onclick="openEdit('don', ${d.id})"><i class="fas fa-pen"></i></button> <button class="action-icon" onclick="deleteItem('don', ${d.id})"><i class="fas fa-trash-alt"></i></button></td></tr>`;
                recentActs.push({date: d.date, rawDate: d.rawDate, name: d.name, type: "‡¶Ö‡¶®‡ßÅ‡¶¶‡¶æ‡¶®", amount: d.amount, color: "warning"});
            });
            document.getElementById('donationsTable').innerHTML = dHtml;

            clubEvents.forEach(e => {
                if(e.type === '‡¶Ü‡ßü') eventIncome += e.amount; else eventExpense += e.amount;
                let cClass = e.type === '‡¶Ü‡ßü' ? 'success' : 'danger'; let sign = e.type === '‡¶Ü‡ßü' ? '+' : '-';
                eHtml += `<tr><td style="text-align:left;"><div style="font-weight:600; color:var(--nav-bg);">${e.name} <span class="badge ${e.type === '‡¶Ü‡ßü' ? 'green' : 'red'}">${e.type}</span></div><div style="font-size:10px; color:var(--text-muted);">${e.date}</div></td><td style="color: var(--${cClass}); font-weight: 600; text-align:right;">${sign} ${formatMoney(e.amount)}</td><td class="admin-only" style="text-align: right;"><button class="action-icon" onclick="openEdit('event', ${e.id})"><i class="fas fa-pen"></i></button> <button class="action-icon" onclick="deleteItem('event', ${e.id})"><i class="fas fa-trash-alt"></i></button></td></tr>`;
                recentActs.push({date: e.date, rawDate: e.rawDate, name: e.name + " (" + e.type + ")", type: "‡¶Ö‡¶®‡ßÅ‡¶∑‡ßç‡¶†‡¶æ‡¶®", amount: e.amount, color: "info"});
            });
            document.getElementById('eventsTable').innerHTML = eHtml;

            document.getElementById('dashTotalFund').innerText = formatMoney(totalFund); document.getElementById('dashTotalLoan').innerText = formatMoney(totalLoanGiven);
            document.getElementById('dashTotalOnudan').innerText = formatMoney(totalDonation); document.getElementById('dashAvailableCash').innerText = formatMoney((totalFund + eventIncome) - (totalLoanGiven + totalDonation + eventExpense));

            recentActs.sort((a, b) => new Date(b.rawDate) - new Date(a.rawDate)); let actHtml = '';
            recentActs.slice(0, 5).forEach(act => {
                let sign = (act.type === '‡¶ï‡¶ø‡¶∏‡ßç‡¶§‡¶ø ‡¶ú‡¶Æ‡¶æ' || act.name.includes('‡¶Ü‡ßü')) ? '+' : '-';
                let amtColor = act.color === 'green' ? 'success' : (act.color === 'warning' ? 'warning' : (act.color === 'info' ? 'info' : 'danger'));
                actHtml += `<tr><td style="text-align:left;"><div style="font-weight:600; color:var(--nav-bg); font-size: 12px;">${act.name}</div><div style="font-size:10px; color:var(--text-muted);">${act.date}</div></td><td style="text-align:center;"><span class="badge ${act.color}">${act.type}</span></td><td style="color: var(--${amtColor}); font-weight: 600; text-align:right;">${sign} ${formatMoney(act.amount)}</td></tr>`;
            });
            document.getElementById('recentActivityTable').innerHTML = actHtml;
        }

        function switchTab(tabId, btn) { document.querySelectorAll('.page-section').forEach(s => { s.style.display = 'none'; s.classList.remove('active'); }); const selectedTab = document.getElementById(tabId); selectedTab.style.display = 'block'; setTimeout(() => selectedTab.classList.add('active'), 10); document.querySelectorAll('.nav-item').forEach(b => b.classList.remove('active')); btn.classList.add('active'); }
        function openModal(id) { document.getElementById(id).classList.add('active'); }
        function closeModal(id) { document.getElementById(id).classList.remove('active'); }
        
        function openQuickAction() { if(!isAdmin) { showCustomAlert('‡¶§‡¶•‡ßç‡¶Ø ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡¶§‡ßá LOGIN ‡¶¨‡¶æ‡¶ü‡¶®‡ßá ‡¶ï‡ßç‡¶≤‡¶ø‡¶ï ‡¶ï‡¶∞‡ßá ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶°‡¶Æ‡¶ø‡¶® ‡¶™‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶≤‡ßá ‡¶™‡ßç‡¶∞‡¶¨‡ßá‡¶∂ ‡¶ï‡¶∞‡ßÅ‡¶®‡•§'); return; } openModal('quickActionModal'); }
        function openKistiModal() { if(!isAdmin) { showCustomAlert("‡¶Ö‡ßç‡¶Ø‡¶æ‡¶°‡¶Æ‡¶ø‡¶® ‡¶≤‡¶ó‡¶á‡¶® ‡¶™‡ßç‡¶∞‡ßü‡ßã‡¶ú‡¶®!"); return; } document.getElementById('kistiDate').value = getIsoToday(); openModal('kistiModal'); }
        function openLoanModal() { if(!isAdmin) { showCustomAlert("‡¶Ö‡ßç‡¶Ø‡¶æ‡¶°‡¶Æ‡¶ø‡¶® ‡¶≤‡¶ó‡¶á‡¶® ‡¶™‡ßç‡¶∞‡ßü‡ßã‡¶ú‡¶®!"); return; } document.getElementById('loanDate').value = getIsoToday(); openModal('loanModal'); }

        function addNewMember() {
            if(!isAdmin) return; let name = document.getElementById('newMemberName').value; let rawD = document.getElementById('newMemberDate').value; let photo = document.getElementById('newMemberPhoto');
            if(!name) { showCustomAlert('‡¶®‡¶æ‡¶Æ ‡¶¶‡¶ø‡¶®!'); return; } let finalD = formatDateBangla(rawD || getIsoToday());
            processAction(() => {
                if(photo.files && photo.files[0]) { let r = new FileReader(); r.onload = e => { members.unshift({ id: Date.now(), name: name, img: e.target.result, joinDate: finalD, history: [] }); renderUI(); }; r.readAsDataURL(photo.files[0]); }
                else { members.unshift({ id: Date.now(), name: name, img: placeholderImg + encodeURIComponent(name), joinDate: finalD, history: [] }); renderUI(); }
                closeModal('addMemberModal'); document.getElementById('newMemberName').value = ''; document.getElementById('newMemberPhoto').value = '';
            }, "‡¶∏‡¶¶‡¶∏‡ßç‡¶Ø ‡¶Ø‡ßÅ‡¶ï‡ßç‡¶§ ‡¶ï‡¶∞‡¶æ ‡¶π‡¶ö‡ßç‡¶õ‡ßá...");
        }

        function openProfile(id) {
            activeMemberId = id; let m = members.find(x => x.id === id);
            let fileInput = document.getElementById('editProfilePhoto'); if(fileInput) fileInput.value = '';
            document.getElementById('profImage').src = m.img; document.getElementById('profName').innerText = m.name; document.getElementById('profDate').innerText = m.joinDate;
            document.getElementById('profTotalKisti').innerText = formatMoney(m.totalKisti); document.getElementById('profTotalLoan').innerText = formatMoney(m.totalLoan);
            let histHtml = '';
            if(m.history) {
                [...m.history].sort((a, b) => new Date(b.rawDate) - new Date(a.rawDate)).forEach(h => {
                    let sign = h.type === '‡¶ï‡¶ø‡¶∏‡ßç‡¶§‡¶ø ‡¶ú‡¶Æ‡¶æ' ? '+' : '-'; let bClass = h.color === 'green' ? 'green' : 'red'; let shortType = h.type === '‡¶ï‡¶ø‡¶∏‡ßç‡¶§‡¶ø ‡¶ú‡¶Æ‡¶æ' ? '‡¶ú‡¶Æ‡¶æ' : '‡¶ã‡¶£';
                    histHtml += `<tr><td style="text-align: left;"><div style="font-weight:600; color:var(--nav-bg);">${h.type}</div><div style="font-size:10px; color:var(--text-muted);">${h.date}</div></td><td style="text-align: center;"><span class="badge ${bClass}">${shortType}</span></td><td style="color: var(--${h.color==='green'?'success':'danger'}); font-weight: 600; text-align: right;">${sign} ${formatMoney(h.amount)}</td><td class="admin-only" style="text-align: right; white-space: nowrap; padding-right: 10px;"><button class="action-icon" onclick="openEdit('trans', ${h.id})"><i class="fas fa-pen"></i></button> <button class="action-icon" onclick="deleteItem('trans', ${h.id})"><i class="fas fa-trash-alt"></i></button></td></tr>`;
                });
            }
            document.getElementById('profHistoryTable').innerHTML = histHtml; openModal('memberProfileModal');
        }

        function submitKisti() {
            if(!isAdmin) return; let amt = parseInt(document.getElementById('kistiAmount').value); let rawD = document.getElementById('kistiDate').value;
            if(!amt) { showCustomAlert('‡¶™‡¶∞‡¶ø‡¶Æ‡¶æ‡¶£ ‡¶¶‡¶ø‡¶®!'); return; }
            processAction(() => { let m = members.find(x => x.id === activeMemberId); if(!m.history) m.history = []; m.history.push({ id: Date.now(), rawDate: rawD, date: formatDateBangla(rawD), type: "‡¶ï‡¶ø‡¶∏‡ßç‡¶§‡¶ø ‡¶ú‡¶Æ‡¶æ", amount: amt, color: "green" }); closeModal('kistiModal'); openProfile(activeMemberId); renderUI(); }, "‡¶ú‡¶Æ‡¶æ ‡¶π‡¶ö‡ßç‡¶õ‡ßá...");
        }
        function submitLoan() {
            if(!isAdmin) return; let amt = parseInt(document.getElementById('loanAmount').value); let rawD = document.getElementById('loanDate').value;
            processAction(() => { let m = members.find(x => x.id === activeMemberId); if(!m.history) m.history = []; m.history.push({ id: Date.now(), rawDate: rawD, date: formatDateBangla(rawD), type: "‡¶ã‡¶£ ‡¶ó‡ßç‡¶∞‡¶π‡¶£", amount: amt, color: "red" }); closeModal('loanModal'); openProfile(activeMemberId); renderUI(); }, "‡¶∏‡ßá‡¶≠ ‡¶π‡¶ö‡ßç‡¶õ‡ßá...");
        }
        function addNewDonation() {
            if(!isAdmin) { showCustomAlert('‡¶Ö‡ßç‡¶Ø‡¶æ‡¶°‡¶Æ‡¶ø‡¶® ‡¶≤‡¶ó‡¶á‡¶® ‡¶™‡ßç‡¶∞‡ßü‡ßã‡¶ú‡¶®‡•§'); return; } let name = document.getElementById('donName').value; let reason = document.getElementById('donReason').value; let amt = parseInt(document.getElementById('donAmount').value); let rawD = document.getElementById('donDate').value;
            if(!name || !amt) { showCustomAlert('‡¶§‡¶•‡ßç‡¶Ø ‡¶¶‡¶ø‡¶®!'); return; }
            processAction(() => { donations.unshift({ id: Date.now(), rawDate: rawD, date: formatDateBangla(rawD), name: name, reason: reason, amount: amt }); closeModal('addDonationModal'); document.getElementById('donName').value = ''; renderUI(); }, "‡¶∏‡ßá‡¶≠ ‡¶π‡¶ö‡ßç‡¶õ‡ßá...");
        }
        function saveEventData() {
            if(!isAdmin) { showCustomAlert('‡¶Ö‡ßç‡¶Ø‡¶æ‡¶°‡¶Æ‡¶ø‡¶® ‡¶≤‡¶ó‡¶á‡¶® ‡¶™‡ßç‡¶∞‡ßü‡ßã‡¶ú‡¶®‡•§'); return; } let name = document.getElementById('eventName').value; let desc = document.getElementById('eventDesc').value; let type = document.getElementById('eventType').value; let amt = parseInt(document.getElementById('eventAmount').value); let rawD = document.getElementById('eventDate').value;
            if(!name || !amt) { showCustomAlert('‡¶§‡¶•‡ßç‡¶Ø ‡¶¶‡¶ø‡¶®!'); return; }
            processAction(() => { clubEvents.unshift({ id: Date.now(), rawDate: rawD, date: formatDateBangla(rawD), name: name, desc: desc, type: type, amount: amt }); closeModal('addEventModal'); document.getElementById('eventName').value = ''; renderUI(); }, "‡¶∏‡ßá‡¶≠ ‡¶π‡¶ö‡ßç‡¶õ‡ßá...");
        }

        function deleteItem(type, id) {
            if(!isAdmin) return;
            showCustomConfirm("‡¶Ü‡¶™‡¶®‡¶ø ‡¶ï‡¶ø ‡¶®‡¶ø‡¶∂‡ßç‡¶ö‡¶ø‡¶§ ‡¶Ø‡ßá ‡¶è‡¶ü‡¶ø ‡¶°‡¶ø‡¶≤‡¶ø‡¶ü ‡¶ï‡¶∞‡¶¨‡ßá‡¶®?", function(confirmed) {
                if(confirmed) {
                    processAction(() => {
                        if(type === 'trans') { let m = members.find(x => x.id === activeMemberId); m.history = m.history.filter(h => h.id !== id); openProfile(activeMemberId); }
                        else if(type === 'don') { donations = donations.filter(d => d.id !== id); } else if(type === 'event') { clubEvents = clubEvents.filter(e => e.id !== id); }
                        renderUI();
                    }, "‡¶°‡¶ø‡¶≤‡¶ø‡¶ü ‡¶π‡¶ö‡ßç‡¶õ‡ßá...");
                }
            });
        }

        function openEdit(type, id) {
            if(!isAdmin) return;
            editType = type; editTargetId = id; document.getElementById('editNameGroup').style.display = 'none'; document.getElementById('editDescGroup').style.display = 'none';
            let obj;
            if(type === 'trans') { obj = members.find(x => x.id === activeMemberId).history.find(x => x.id === id); }
            else if(type === 'don') { obj = donations.find(x => x.id === id); document.getElementById('editNameGroup').style.display = 'block'; document.getElementById('editDescGroup').style.display = 'block'; document.getElementById('editUName').value = obj.name; document.getElementById('editUDesc').value = obj.reason; }
            else if(type === 'event') { obj = clubEvents.find(x => x.id === id); document.getElementById('editNameGroup').style.display = 'block'; document.getElementById('editDescGroup').style.display = 'block'; document.getElementById('editUName').value = obj.name; document.getElementById('editUDesc').value = obj.desc; }
            document.getElementById('editUDate').value = obj.rawDate; document.getElementById('editUAmount').value = obj.amount; openModal('editUniversalModal');
        }

        function saveEditedUniversal() {
            if(!isAdmin) return;
            let newDate = document.getElementById('editUDate').value; let newAmt = parseInt(document.getElementById('editUAmount').value);
            if(!newAmt) { showCustomAlert('‡¶™‡¶∞‡¶ø‡¶Æ‡¶æ‡¶£ ‡¶¶‡¶ø‡¶®!'); return; }
            processAction(() => {
                if(editType === 'trans') { let h = members.find(x => x.id === activeMemberId).history.find(x => x.id === editTargetId); h.rawDate = newDate; h.date = formatDateBangla(newDate); h.amount = newAmt; openProfile(activeMemberId); }
                else if(editType === 'don') { let d = donations.find(x => x.id === editTargetId); d.rawDate = newDate; d.date = formatDateBangla(newDate); d.amount = newAmt; d.name = document.getElementById('editUName').value; d.reason = document.getElementById('editUDesc').value; }
                else if(editType === 'event') { let e = clubEvents.find(x => x.id === editTargetId); e.rawDate = newDate; e.date = formatDateBangla(newDate); e.amount = newAmt; e.name = document.getElementById('editUName').value; e.desc = document.getElementById('editUDesc').value; }
                closeModal('editUniversalModal'); renderUI();
            }, "‡¶π‡¶ø‡¶∏‡¶æ‡¶¨ ‡¶Ü‡¶™‡¶°‡ßá‡¶ü ‡¶π‡¶ö‡ßç‡¶õ‡ßá...");
        }

    </script>
</body>
</html>
